import dlt
from pyspark.sql.functions import col, split
from utilities import utils


# This file defines a sample transformation.
# Edit the sample below or add new transformations
# using "+ Add" in the file browser.


@dlt.table
def sample_trips_{{ .project_name }}():
    return spark.read.table("samples.wanderbricks.users").withColumn(
        "email_domain", split(col("email"), "@").getItem(1)
    )
