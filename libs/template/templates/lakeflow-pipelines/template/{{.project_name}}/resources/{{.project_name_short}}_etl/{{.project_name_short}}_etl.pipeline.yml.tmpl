# The main pipeline for {{.project_name}}

{{- $serverless := (eq .serverless "yes")}}

resources:
  pipelines:
    {{.project_name_short}}_etl:
      {{- /* Note that pipeline names must be unique in a worskspace,
           * so we use the project name as part as the name.
           */}}
      name: {{.project_name_short}}_etl
{{- if or (eq default_catalog "") (eq default_catalog "hive_metastore")}}
  {{- if $serverless }}
      ## Catalog is required for serverless compute
      catalog: ${var.catalog}
  {{- else}}
      ## Specify the 'catalog' field to configure this pipeline to make use of Unity Catalog:
      # catalog: ${var.catalog}
  {{- end}}
{{- else}}
      catalog: ${var.catalog}
{{- end}}
      schema: ${var.schema}
{{- if $serverless }}
      serverless: true
{{- end}}
      root_path: "."

      libraries:
        - glob:
            include: transformations/**

{{- if eq .include_python "yes"}}
      environment:
        dependencies:
          # By default we include the .whl file generated for the project's pyproject.toml
          # in the root of this project. Any other dependencies can be added there.
          - ../../dist/*.whl
{{- end}}
