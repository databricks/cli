export DATABRICKS_CLI_TELEMETRY_PID_FILE=./telemetry.pid
export DATABRICKS_CLI_TELEMETRY_UPLOAD_LOGS_FILE=./out.upload_process.txt

# Unset the token which is configured by default
# in acceptance tests
export DATABRICKS_TOKEN=""

export DATABRICKS_CLIENT_ID=client_id
export DATABRICKS_CLIENT_SECRET=client_secret

trace $CLI selftest send-telemetry

echo "waiting for telemetry process to finish"

# Wait for the child telemetry process to finish
wait_pid.py $(cat ./telemetry.pid)

# cleanup the pid file
rm -f ./telemetry.pid
