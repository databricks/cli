trace $CLI bundle init default-python --config-file ./input.json --output-dir output

cd output/fail_missing_uv
trace $CLI bundle validate

# Dynamically find ALL directories containing 'uv' and remove them from PATH
for uv_path in $(which -a uv 2>/dev/null); do
  uv_dir=$(dirname "$uv_path")
  export PATH=$(echo "$PATH" | tr ':' '\n' | grep -v "^$uv_dir$" | paste -sd: -)
done

# Try to deploy, expect failure due to missing uv
errcode trace $CLI bundle deploy
