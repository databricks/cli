mkdir output

function testCase() {
    project_name=$1

    trace $CLI bundle init default-python --config-file ./input.json --output-dir output

    # only keep relevant files for snapshots
    trace find output/$project_name -mindepth 1 -maxdepth 2 ! -name 'pyproject.toml' ! -regex '.*/resources/.*' -delete
}

for include_notebook in yes no; do
  for include_python in yes no; do
    for include_dlt in yes no; do
      for serverless in yes no; do
        project_name="pydabs"
        [[ $include_notebook == yes ]] && project_name+="_notebook"
        [[ $include_python == yes ]] && project_name+="_python"
        [[ $include_dlt == yes ]] && project_name+="_dlt"
        [[ $serverless == yes ]] && project_name+="_serverless"

        include_notebook=$include_notebook \
        include_python=$include_python \
        include_dlt=$include_dlt \
        serverless=$serverless \
        project_name=$project_name \
        envsubst < input.json.tmpl > input.json

        echo "== $project_name =="
        testCase $project_name
      done
    done
  done
done