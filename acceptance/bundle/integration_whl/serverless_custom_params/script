envsubst < databricks.yml.tmpl > databricks.yml

cleanup() {
    trace $CLI bundle destroy --auto-approve
}
trap cleanup EXIT

trace $CLI bundle deploy

# Add all resource IDs to runtime replacements to avoid pattern matching ambiguity
replace_ids.py

trace $CLI bundle run some_other_job
trace $CLI bundle run some_other_job --python-params=param1,param2
