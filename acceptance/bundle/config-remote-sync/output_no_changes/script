#!/bin/bash

envsubst < databricks.yml.tmpl > databricks.yml

cleanup() {
  trace $CLI bundle destroy --auto-approve
}
trap cleanup EXIT

touch dummy.whl
$CLI bundle deploy

title "Check for changes immediately after deployment"
echo
$CLI bundle config-remote-sync

title "Text output"
echo
$CLI bundle config-remote-sync | contains.py "No changes detected"

title "JSON output"
echo
$CLI bundle config-remote-sync -o json > out.json
cat out.json
