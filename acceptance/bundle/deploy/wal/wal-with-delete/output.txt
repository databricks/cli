=== Creating state directory ===
=== Creating state file (job exists) ===
=== Creating WAL with delete entry (simulating crash during delete) ===
=== WAL content ===
{"lineage":"delete-test-lineage","serial": [SERIAL]}
{"k":"resources.jobs.test_job","v":null}
=== Updating config to remove job ===
=== Deploy (should recover delete from WAL) ===

>>> [CLI] bundle deploy
Uploading bundle files to /Workspace/Users/[USERNAME]/.bundle/wal-delete-test/default/files...
Recovering state from WAL file: [TEST_TMP_DIR]/.databricks/bundle/default/resources.json.wal
Recovered 1 entries from WAL file.
Deploying resources...
Updating deployment state...
Deployment complete!
=== Final state (should have no jobs) ===
{
  "serial": [SERIAL],
  "state_keys": []
}
=== WAL after successful deploy ===
WAL deleted (expected)
