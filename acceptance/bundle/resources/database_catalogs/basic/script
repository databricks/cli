envsubst < databricks.yml.tmpl > databricks.yml

cleanup() {
  trace $CLI bundle destroy --auto-approve
}
trap cleanup EXIT

trace $CLI bundle validate

# URL is excluded because some cloud envs add an ?0= query param and some don't
trace $CLI bundle summary | grep -v "URL"
trace $CLI bundle deploy
trace $CLI bundle summary | grep -v "URL"
