trace $CLI bundle validate -o json | jq .resources.dashboards.foo.permissions
rm out.requests.txt

$CLI bundle debug plan > out.plan.$DATABRICKS_BUNDLE_ENGINE.json

print_requests() {
    jq -c < out.requests.txt | jq 'select(.method != "GET" and (.path | contains("permissions")))'
    rm out.requests.txt
}

# create the parent path
trace $CLI workspace mkdirs /Users/tester@databricks.com/folder1

rm out.requests.txt
trace $CLI bundle deploy

dashboard_id=$($CLI bundle summary --output json | jq -r '.resources.dashboards.foo.id')
echo "$dashboard_id:DASHBOARD_ID" >> ACC_REPLS

print_requests > out.requests.deploy.$DATABRICKS_BUNDLE_ENGINE.json

trace $CLI bundle destroy --auto-approve
print_requests > out.requests.destroy.$DATABRICKS_BUNDLE_ENGINE.json
