print_requests() {
    jq 'select(.path | contains("/jobs/")) | select(.method != "GET")' < out.requests.txt
    rm out.requests.txt
}

print_sorted_requests() {
    jq -c < out.requests.txt | sort | jq --sort-keys 'select(.path | contains("/jobs/")) | select(.method != "GET")'
    rm out.requests.txt
}

trace $CLI bundle plan
$CLI bundle debug plan > out.plan.$DATABRICKS_BUNDLE_ENGINE.json
trace $CLI bundle deploy
print_requests > out.requests_create.$DATABRICKS_BUNDLE_ENGINE.json

trace $CLI bundle destroy --auto-approve
print_requests > out.requests_delete.$DATABRICKS_BUNDLE_ENGINE.json
