bundle:
  name: many-permissions-test

sync:
  exclude:
    - out*

resources:
  jobs:
    fooj:
      name: job foo
      tasks:
        - task_key: main
          notebook_task:
            notebook_path: /Workspace/Users/user@example.com/notebook
            source: WORKSPACE
      permissions:
        - level: CAN_VIEW
          user_name: viewer@example.com
        - level: CAN_MANAGE
          group_name: data-team
    barj:
      # dependencies sequence the resources.
      # Note, that sequencing does not apply to permissions, those can still have different order
      name: job bar ${resources.jobs.fooj.name}
      tasks:
        - task_key: main
          notebook_task:
            notebook_path: /Workspace/Users/user@example.com/notebook
            source: WORKSPACE
      permissions:
        - level: CAN_VIEW
          user_name: viewer1@example.com
        - level: CAN_MANAGE
          group_name: data-team
        - level: CAN_MANAGE
          user_name: tester@databricks.com
  pipelines:
    foop:
      name: pipeline foo ${resources.jobs.barj.name}
      permissions:
        - level: CAN_VIEW
          user_name: viewer@example.com
        - level: CAN_MANAGE
          group_name: data-team
        - level: CAN_MANAGE
          service_principal_name: servicebot
        - level: CAN_MANAGE
          user_name: admin@databricks.com
    barp:
      name: pipeline bar ${resources.pipelines.foop.name}
      tasks:
        - task_key: main
          notebook_task:
            notebook_path: /Workspace/Users/user@example.com/notebook
            source: WORKSPACE
      permissions:
        - level: CAN_VIEW
          user_name: viewer1@example.com
        - level: CAN_MANAGE
          group_name: data-team
        - level: CAN_MANAGE
          user_name: tester@databricks.com
        - level: IS_OWNER
          user_name: tester@databricks.com
