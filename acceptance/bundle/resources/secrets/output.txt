
=== Deploy the secret scope first
>>> [CLI] bundle deploy
Uploading bundle files to /Workspace/Users/[USERNAME]/.bundle/deploy-secrets-test-[UNIQUE_NAME]/default/files...
Deploying resources...
Updating deployment state...
Deployment complete!

=== Verify the secret scope was created
>>> [CLI] secrets list-scopes -o json
{
  "backend_type": "DATABRICKS",
  "name": "secrets-test-[UUID]"
}

=== Create a secret via CLI
>>> [CLI] secrets put-secret secrets-test-[UUID] my-secret-key --string-value my-secret-value

=== Verify secret was created
>>> [CLI] secrets get-secret secrets-test-[UUID] my-secret-key
{
  "key":"my-secret-key",
  "value":"bXktc2VjcmV0LXZhbHVl"
}

=== Now add a secret to the bundle
=== Deploy bundle with secret (scope already exists)
>>> [CLI] bundle deploy
Uploading bundle files to /Workspace/Users/[USERNAME]/.bundle/deploy-secrets-test-[UNIQUE_NAME]/default/files...
Deploying resources...
Updating deployment state...
Deployment complete!

=== Verify bundle secret was created
>>> [CLI] secrets get-secret secrets-test-[UUID] bundle_secret
{
  "key":"bundle_secret",
  "value":"YnVuZGxlLXNlY3JldC12YWx1ZQ=="
}

>>> [CLI] bundle destroy --auto-approve
The following resources will be deleted:
  delete resources.secret_scopes.test_scope
  delete resources.secrets.secret1

All files and directories at the following location will be deleted: /Workspace/Users/[USERNAME]/.bundle/deploy-secrets-test-[UNIQUE_NAME]/default

Deleting files...
Destroy complete!
