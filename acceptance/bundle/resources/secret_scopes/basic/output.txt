
=== create the secret scope
>>> [CLI] bundle plan
create secret_scopes.my_scope

Plan: 1 to add, 0 to change, 0 to delete, 0 unchanged

>>> [CLI] bundle deploy
Uploading bundle files to /Workspace/Users/[USERNAME]/.bundle/secret-scope-basic-[UNIQUE_NAME]/default/files...
Deploying resources...
Updating deployment state...
Deployment complete!

>>> [CLI] secrets list-scopes -o json
{
  "backend_type": "DATABRICKS",
  "name": "test-scope-[UNIQUE_NAME]-1"
}

=== put and get secret in first scope
>>> [CLI] secrets put-secret test-scope-[UNIQUE_NAME]-1 my-key --string-value my-secret-value

>>> [CLI] secrets get-secret test-scope-[UNIQUE_NAME]-1 my-key
{
  "key":"my-key",
  "value":"bXktc2VjcmV0LXZhbHVl"
}

=== update the name of the scope (should recreate)
>>> [CLI] bundle plan
recreate secret_scopes.my_scope

Plan: 1 to add, 0 to change, 1 to delete, 0 unchanged

>>> [CLI] bundle deploy
Uploading bundle files to /Workspace/Users/[USERNAME]/.bundle/secret-scope-basic-[UNIQUE_NAME]/default/files...
Deploying resources...
Updating deployment state...
Deployment complete!

>>> [CLI] secrets list-scopes -o json
{
  "backend_type": "DATABRICKS",
  "name": "test-scope-[UNIQUE_NAME]-2"
}

=== put and get secret in recreated scope
>>> [CLI] secrets put-secret test-scope-[UNIQUE_NAME]-2 another-key --string-value another-secret-value

>>> [CLI] secrets get-secret test-scope-[UNIQUE_NAME]-2 another-key
{
  "key":"another-key",
  "value":"YW5vdGhlci1zZWNyZXQtdmFsdWU="
}

>>> [CLI] bundle destroy --auto-approve
The following resources will be deleted:
  delete secret_scope my_scope

All files and directories at the following location will be deleted: /Workspace/Users/[USERNAME]/.bundle/secret-scope-basic-[UNIQUE_NAME]/default

Deleting files...
Destroy complete!
