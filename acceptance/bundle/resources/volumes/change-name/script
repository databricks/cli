trace $CLI bundle deploy

print_requests() {
    jq 'select(.method != "GET" and (.path | contains("/unity")))' < out.requests.txt
    rm out.requests.txt
}

trace print_requests

title "Summary should now show id and url\n"
$CLI bundle summary -o json | jq .resources

title "Update name"
trace update_file.py databricks.yml myvolume mynewvolume

trace $CLI bundle plan
# terraform marks this as "update", direct marks this as "update_with_id"
trace $CLI bundle plan -o json > out.plan.$DATABRICKS_BUNDLE_ENGINE.txt
trace $CLI bundle deploy
trace print_requests

trace $CLI volumes read main.myschema.mynewvolume
trace musterr $CLI volumes read main.myschema.myvolume
rm out.requests.txt
