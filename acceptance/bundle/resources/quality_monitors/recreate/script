echo "*" > .gitignore
trace $CLI bundle deploy

print_requests() {
    jq 'select(.method != "GET" and (.path | contains("/unity-catalog/tables")))' < out.requests.txt
    rm out.requests.txt
}

trace print_requests
trace $CLI bundle summary -o json | jq .resources.quality_monitors

title "Update assets_dir and re-deploy (should recreate)"
trace update_file.py databricks.yml assets1 assets2
trace $CLI bundle plan | contains.py recreate
trace $CLI bundle deploy --auto-approve
trace print_requests
