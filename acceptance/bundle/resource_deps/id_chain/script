print_all_requests() {
    jq --sort-keys 'select(.path | contains("/jobs"))' < out.requests.txt
    rm out.requests.txt
}

print_requests() {
    jq --sort-keys 'select(.method != "GET" and (.path | contains("/jobs")))' < out.requests.txt
    rm out.requests.txt
}

print_requests_short() {
    jq --sort-keys 'select(.method != "GET" and (.path | contains("/jobs"))) | (.body.name // .body.new_settings.name // empty)' < out.requests.txt
    rm out.requests.txt
}

trace $CLI bundle plan
trace print_requests

$CLI bundle debug plan > out.plan_create.$DATABRICKS_BUNDLE_ENGINE.json
trace print_requests

trace $CLI bundle deploy
trace print_requests_short

trace update_file.py databricks.yml aa_desc aa_new_desc
trace update_file.py databricks.yml prefix new_prefix

$CLI bundle debug plan > out.plan_update.$DATABRICKS_BUNDLE_ENGINE.json
trace print_requests

trace $CLI bundle plan
trace print_requests

trace $CLI bundle deploy
trace print_requests_short

$CLI bundle debug plan > out.plan_skip.$DATABRICKS_BUNDLE_ENGINE.json
trace print_requests
