export DATABRICKS_CACHE_DIR=$(pwd)/.cache

$CLI cache clear &> /dev/null

title "First call in a session is expected to be a cache miss:\n"
trace $CLI bundle validate --debug 2>&1 | grep "Local Cache" | grep -v "cache path"

title "Second call in a session is expected to be a cache hit\n"
trace $CLI bundle validate --debug 2>&1 | grep "Local Cache" | grep -v "cache path"

trace $CLI cache clear

title "First call after a clear is expected to be a cache miss:\n"
trace $CLI bundle validate --debug 2>&1 | grep "Local Cache" | grep -v "cache path"

rm -rf "${DATABRICKS_CACHE_DIR}"
