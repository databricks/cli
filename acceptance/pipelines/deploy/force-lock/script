# Create a lock file to simulate another process holding the lock
export username=$($CLI current-user me | jq -r .userName)
trace errcode $CLI workspace import Workspace/Users/[USERNAME]/.bundle/test-pipeline-force-lock/default/state/deploy.lock --format AUTO --file ./deploy.lock

# Try to deploy without force-lock - should fail due to existing lock
echo "=== Testing deployment without force-lock (should fail) ==="
trace errcode $CLI bundle deploy

# Deploy with force-lock - should succeed
echo "=== Testing deployment with force-lock (should succeed) ==="
trace $PIPELINES deploy --force-lock
