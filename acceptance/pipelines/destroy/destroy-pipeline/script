title "Test basic pipelines destroy"
trace $CLI pipelines deploy
PIPELINE_ID=$($CLI bundle summary -o json | jq -r '.resources.pipelines.my_pipeline.id')
# --auto-approve is required because the test environment cannot provide interactive confirmation
trace $CLI pipelines destroy --auto-approve

title "Assert pipeline is deleted"
# Should fail because the pipeline is deleted
trace errcode $CLI pipelines get "${PIPELINE_ID}"
